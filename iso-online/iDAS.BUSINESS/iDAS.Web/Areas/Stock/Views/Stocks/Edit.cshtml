@using Ext.Net.MVC
@using Ext.Net
@using iDAS.Utilities
@using iDAS.Web.ExtExtend
@model iDAS.Items.StockItem
@(Html.X().Window()
.ID("winEditStock")
.Title("Sửa thông tin kho")
.Icon(Icon.Pencil)
.Height(430)
.Width(800)
.BodyPadding(6)
.Constrain(true)
.Modal(true)
.Layout(LayoutType.Fit)
.Items(
Html.X().FormPanel()
.ID("frEditStock")
.Layout(LayoutType.Anchor)
.Frame(true)
.StyleSpec("border: none;")
.FieldDefaults(d => d.LabelAlign = LabelAlign.Left)
.Items(
Html.X().Container()
        .Layout(LayoutType.Column)
        .MarginSpec("0 0 0 0")
        .Items(  
        Html.X().Container()
        .ColumnWidth(0.6)
        .MarginSpec("0 0 0 0")
        .Layout(LayoutType.Form)
        .Items( 
Html.X().FieldSet()
        .Title("Thông tin bắt buộc")
        .MarginSpec("0 0 0 0")
        .Layout(LayoutType.Form)
        .Height(85)        
        .Items(
        Html.X().Container()
                .MarginSpec("0 0 0 0")
                .Layout(LayoutType.Column)
                .Items(
                Html.X().HiddenFor(m=>m.ID), 
        Html.X().TextFieldFor(m => m.Code)                
                .FieldLabel("Mã kho "+ Html.Required())
                .ID("txtCode")
                .MaxLength(20)
                .ReadOnly(true)
                .MaxLengthText("Trường không vượt quá 20 ký tự")               
                .AllowBlank(false)
                .LabelWidth(70)
                .ColumnWidth(0.7)
                .BlankText("Mã kho không được để trống")
                .AllowOnlyWhitespace(false)
                .AnchorHorizontal("100%")
                .TabIndex(1),
        Html.X().CheckboxFor(m=>m.Active)
                .HideLabel(true)
                .MarginSpec("0 0 0 5")             
                .BoxLabel("Còn quản lý")
                .ColumnWidth(0.3)
                .TabIndex(2)
                ),
           Html.X().TextFieldFor(m => m.Name)                
                .FieldLabel("Tên kho "+ Html.Required())
                .ID("txtName")
                .AllowBlank(false)
                .LabelWidth(70)
                .MaxLength(200)  
                .MaxLengthText("Trường không vượt quá 200 ký tự")                           
                .BlankText("Mã kho không được để trống")
                .AllowOnlyWhitespace(false)
                .AnchorHorizontal("100%")
                .TabIndex(3)        
        ),
        Html.X().FieldSet()
                .Title("Thông tin khác")
                .MarginSpec("0 0 0 0")
                .Height(250)
                .Layout(LayoutType.Form)
                .Items(
                 Html.X().TextFieldFor(m => m.Manager)                
                        .FieldLabel("Người quản lý")
                        .ID("txtManager")            
                        .LabelWidth(80)
                        .MaxLength(255)
                        .MaxLengthText("Trường không vượt quá 255 ký tự")
                        .AnchorHorizontal("100%")
                        .TabIndex(4),
                Html.X().TextFieldFor(m => m.Contact)                
                        .FieldLabel("Người liên hệ")
                        .ID("txtContact")            
                        .LabelWidth(80)
                        .MaxLength(255)
                        .MaxLengthText("Trường không vượt quá 255 ký tự")                             
                        .AnchorHorizontal("100%")
                        .TabIndex(5),
                Html.X().TextFieldFor(m => m.Address)                
                        .FieldLabel("Địa chỉ kho")
                        .ID("txtAddress")            
                        .LabelWidth(80) 
                        .MaxLength(255)
                        .MaxLengthText("Trường không vượt quá 255 ký tự")                        
                        .AnchorHorizontal("100%")
                        .TabIndex(6),
                Html.X().Container()
                        .Layout(LayoutType.Column)
                        .Items(
                         Html.X().TextFieldFor(m => m.Telephone)                
                        .FieldLabel("Điện thoại")
                        .ID("txtTelephone")   
                        .Regex("/\\(?([0-9]{3})\\)?([ .-]?)([0-9]{3})\\2([0-9]{4})/")
                                .RegexText("Nhập sai định dạng số điện thoại ((084)987789456 / 0987789456)")         
                        .LabelWidth(80)
                        .MaxLength(20)
                        .MaxLengthText("Trường không vượt quá 20 ký tự")  
                        .ColumnWidth(0.5)
                        .AnchorHorizontal("100%")
                        .TabIndex(7),
                         Html.X().TextFieldFor(m => m.Mobi)                
                        .FieldLabel("Mobile")
                        .MarginSpec("0 0 0 5")
                        .Regex("/\\(?([0-9]{3})\\)?([ .-]?)([0-9]{3})\\2([0-9]{4})/")
                                .RegexText("Nhập sai định dạng số điện thoại ((084)987789456 / 0987789456)")
                        .ID("txtMobi")
                        .ColumnWidth(0.5)           
                        .LabelWidth(70) 
                        .MaxLength(20)
                        .MaxLengthText("Trường không vượt quá 20 ký tự")     
                        .AnchorHorizontal("100%")
                        .TabIndex(8)                        
                        ),
                Html.X().Container()
                        .Layout(LayoutType.Column)
                        .Items(
                           Html.X().TextFieldFor(m => m.Fax)                
                        .FieldLabel("Fax")
                        .ID("txtFax")            
                        .LabelWidth(80) 
                        .MaxLength(20)
                        .Regex("/\\(?([0-9]{3})\\)?([ .-]?)([0-9]{3})\\2([0-9]{4})/")
                                .RegexText("Nhập sai định dạng số fax ((084)987789456 / 0987789456)")
                        .MaxLengthText("Trường không vượt quá 20 ký tự")     
                        .ColumnWidth(0.5)
                        .AnchorHorizontal("100%")
                        .TabIndex(9),
                         Html.X().TextFieldFor(m => m.Email)                
                        .FieldLabel("Email")
                        .MarginSpec("0 0 0 5")
                        .ID("txtEmail")
                        .ColumnWidth(0.5)           
                        .LabelWidth(70)
                        .StandardVtype(ValidationType.Email) 
                        .MaxLength(50)
                        .MaxLengthText("Trường không vượt quá 50 ký tự")
                        .ValidatorText("Email không đúng định dạng")     
                        .AnchorHorizontal("100%")
                        .TabIndex(10)
                        ),               
               Html.X().TextAreaFor(m => m.Description)                
                        .FieldLabel("Mục đích sử dụng")
                        .ID("txtDescription")
                        .MaxLength(255)
                        .MaxLengthText("Trường không vượt quá 255 ký tự")           
                        .LabelWidth(80)
                        .Height(80)                                                        
                        .AnchorHorizontal("100%")
                        .TabIndex(11)
        
                )        
        ),
    Html.X().Container()           
            .ColumnWidth(0.4)
            .Layout(LayoutType.Fit)
            .Items( 
        Html.X().FieldSet()
                .MarginSpec("4 0 0 5")
                .Title("Sơ đồ kho")
                .Height(335)               
                .Items(
                Html.X().ImageButton()
                .ID("imgMap")
                .ToolTip("Click vào ảnh để chọn ảnh sơ đồ kho")
                .TabIndex(12)
                .Width(279)
                .Height(275)            
                .ImageUrl(Model.ImageUrl),
                         Html.X().FileUploadField().ID("FileUploadImageFieldId")
                         .ButtonText("Ảnh sơ đồ kho")
                         .MarginSpec("5 0 0 0")
                         .ButtonOnly(false)
                         .Width(279)
                         .Icon(Icon.ImageEdit)
                             .Listeners(ls => ls.Change.Handler = "imageMapChange(this);")         
                )       
        ) 
        )
        )
        )
        .Buttons(
        Html.X().ButtonSave()
        .ID("btnSave")
        .DirectEvents(de =>
        {          
            de.Click.ExtraParams.Add(new { val = false });
            de.Click.Before = @"if (!App.frEditStock.getForm().isValid()) { return false; } ";
            de.Click.Action = "Update";
            de.Click.FormID = "frEditStock";
        }),        
        Html.X().ButtonExit()
        )
    )